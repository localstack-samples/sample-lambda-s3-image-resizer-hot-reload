version: 0.2

# env:
#   variables:
#     AWS_DEFAULT_REGION: us-east-1
#     AWS_REGION: us-east-1
#     AWS_ACCESS_KEY_ID: test
#     AWS_SECRET_ACCESS_KEY: test

phases:
  install:
    runtime-versions:
      python: 3.9
    commands:
      - pip install -r requirements-dev.txt
  pre_build:
    steps:
      - name: Start LocalStack
        uses: LocalStack/setup-localstack@main
        with:
          image-tag: 'latest'
          use-pro: 'true'
          configuration: LS_LOG=trace
          install-awslocal: 'true'
        # env:
        #   LOCALSTACK_AUTH_TOKEN: $LOCALSTACK_AUTH_TOKEN
      - run: bin/deploy.sh
  build:
    commands:
      - pytest tests
